<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Toward sustainable and resilient fisheries management for the Humboldt squid deep-water fishery - 1&nbsp; Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eda.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./methods.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Methods</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Toward sustainable and resilient fisheries management for the Humboldt squid deep-water fishery</a> 
        <div class="sidebar-tools-main">
    <a href="./Toward-sustainable-and-resilient-fisheries-management-for-the-Humboldt-squid-deep-water-fishery.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methods.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-sources" id="toc-data-sources" class="nav-link active" data-scroll-target="#data-sources"><span class="header-section-number">1.1</span> Data sources</a>
  <ul class="collapse">
  <li><a href="#sea-surface-temperature-sst" id="toc-sea-surface-temperature-sst" class="nav-link" data-scroll-target="#sea-surface-temperature-sst"><span class="header-section-number">1.1.1</span> Sea surface temperature (SST)</a></li>
  <li><a href="#sea-surface-temperature-sst-forecasts-under-climate-change" id="toc-sea-surface-temperature-sst-forecasts-under-climate-change" class="nav-link" data-scroll-target="#sea-surface-temperature-sst-forecasts-under-climate-change"><span class="header-section-number">1.1.2</span> Sea surface temperature (SST) forecasts under climate change</a></li>
  <li><a href="#oceanic-niño-index-oni" id="toc-oceanic-niño-index-oni" class="nav-link" data-scroll-target="#oceanic-niño-index-oni"><span class="header-section-number">1.1.3</span> Oceanic Niño Index (ONI)</a></li>
  <li><a href="#ais-based-fishing-effort" id="toc-ais-based-fishing-effort" class="nav-link" data-scroll-target="#ais-based-fishing-effort"><span class="header-section-number">1.1.4</span> AIS-based Fishing effort</a></li>
  <li><a href="#vessel-info" id="toc-vessel-info" class="nav-link" data-scroll-target="#vessel-info"><span class="header-section-number">1.1.5</span> Vessel info</a></li>
  <li><a href="#night-light-detections-using-viirs-visible-infrared-imaging-radiometer-suite" id="toc-night-light-detections-using-viirs-visible-infrared-imaging-radiometer-suite" class="nav-link" data-scroll-target="#night-light-detections-using-viirs-visible-infrared-imaging-radiometer-suite"><span class="header-section-number">1.1.6</span> Night light detections using VIIRS (Visible Infrared Imaging Radiometer Suite)</a></li>
  <li><a href="#eez-information" id="toc-eez-information" class="nav-link" data-scroll-target="#eez-information"><span class="header-section-number">1.1.7</span> EEZ information</a></li>
  <li><a href="#joined-datasets" id="toc-joined-datasets" class="nav-link" data-scroll-target="#joined-datasets"><span class="header-section-number">1.1.8</span> Joined datasets</a></li>
  <li><a href="#joined-datasets-1" id="toc-joined-datasets-1" class="nav-link" data-scroll-target="#joined-datasets-1"><span class="header-section-number">1.1.9</span> Joined datasets</a></li>
  </ul></li>
  <li><a href="#geographic-analysis-scope" id="toc-geographic-analysis-scope" class="nav-link" data-scroll-target="#geographic-analysis-scope"><span class="header-section-number">1.2</span> Geographic analysis scope</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-methods" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Methods</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="data-sources" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="data-sources"><span class="header-section-number">1.1</span> Data sources</h2>
<section id="sea-surface-temperature-sst" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="sea-surface-temperature-sst"><span class="header-section-number">1.1.1</span> Sea surface temperature (SST)</h3>
<p>Sea surface temperature (SST) data come from <a href="https://coastwatch.pfeg.noaa.gov/erddap/griddap/ncdcOisst21Agg.html">NOAA’s Optimum Interpolation Sea Surface Temperature (OISST) version 2.1</a> (<span class="citation" data-cites="huang2021improvements">Huang et al. (<a href="references.html#ref-huang2021improvements" role="doc-biblioref">2021</a>)</span>), which were downloaded from their Coast Watch ERDDAP server. The raw data are provided globally at 0.25x0.25 degree daily resolution. Keeping the full 0.25x0.25 degree spatial resolution, we temporally aggregate the daily data to monthly resolution by calculating the mean, standard deviation, minimum, and maximum from across the days in each month.</p>
</section>
<section id="sea-surface-temperature-sst-forecasts-under-climate-change" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="sea-surface-temperature-sst-forecasts-under-climate-change"><span class="header-section-number">1.1.2</span> Sea surface temperature (SST) forecasts under climate change</h3>
<p>We use SST forecasts under climate change from the <a href="https://interactive-atlas.ipcc.ch/regional-information#eyJ0eXBlIjoiQVRMQVMiLCJjb21tb25zIjp7ImxhdCI6OTc3MiwibG5nIjo0MDA2OTIsInpvb20iOjQsInByb2oiOiJFUFNHOjU0MDMwIiwibW9kZSI6ImNvbXBsZXRlX2F0bGFzIn0sInByaW1hcnkiOnsic2NlbmFyaW8iOiJzc3A1ODUiLCJwZXJpb2QiOiJmYXIiLCJzZWFzb24iOiJ5ZWFyIiwiZGF0YXNldCI6IkNNSVA2IiwidmFyaWFibGUiOiJ0b3MiLCJ2YWx1ZVR5cGUiOiJWQUxVRSIsImhhdGNoaW5nIjoiU0lNUExFIiwicmVnaW9uU2V0IjoiYXI2IiwiYmFzZWxpbmUiOiJwcmVJbmR1c3RyaWFsIiwicmVnaW9uc1NlbGVjdGVkIjpbXX0sInBsb3QiOnsiYWN0aXZlVGFiIjoicGx1bWUiLCJtYXNrIjoibm9uZSIsInNjYXR0ZXJZTWFnIjpudWxsLCJzY2F0dGVyWVZhciI6bnVsbCwic2hvd2luZyI6ZmFsc2V9fQ==">IPCC WGI Interactive Atlas</a>(<span class="citation" data-cites="iturbide2021repository">Iturbide et al. (<a href="references.html#ref-iturbide2021repository" role="doc-biblioref">2021</a>)</span>). The Atlas provides a platform for accessing ensemble forecasts from CMIP6 (Coupled Model Intercomparison Project Phase 6), which represent the latest global climate forecasts available and served as the basis of the <a href="https://www.ipcc.ch/assessment-report/ar6/">6th IPCC Assessment Report</a>.</p>
<p>We pull 1x1 degree monthly mean SST data for three time horizons:</p>
<ol type="1">
<li>Near Term (2021-2040)</li>
<li>Medium Term (2041-2060)</li>
<li>Long Term (2081-2100)</li>
</ol>
<p>And for each time horizon, we pull data from four climate change scenarios (more information on the scenarios can be found <a href="https://climate-scenarios.canada.ca/?page=cmip6-overview-notes">here</a>:</p>
<ol type="1">
<li>SSP1-2.6</li>
<li>SSP2-4.5</li>
<li>SSP3-7.0</li>
<li>SSP5-8.5</li>
</ol>
<p>This gives us a total of 12 different forecasts to analyze. The dataset can be loaded in targets using <code>targets::tar_load(sst_cc_forecast_data)</code>, and it has the following columns:</p>
<ul>
<li><strong>lon_bin</strong>: 1x1 degree longitude bin (degrees) (numeric)<br>
</li>
<li><strong>lat_bin</strong>: 1x1 degree latitude bin (degrees) (numeric)<br>
</li>
<li><strong>sst_deg_c_mean</strong>: Mean sea surface temperature from across the ensemble of CMIP6 models (degrees C) (numeric)</li>
<li><strong>time_period</strong>: Future time horizon forecast time period (character)</li>
<li><strong>scenario</strong>: Climate change scenario (character)</li>
<li><strong>month_number</strong>: Month number (numeric)</li>
</ul>
</section>
<section id="oceanic-niño-index-oni" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="oceanic-niño-index-oni"><span class="header-section-number">1.1.3</span> Oceanic Niño Index (ONI)</h3>
<p>According to <a href="https://www.climate.gov/news-features/understanding-climate/climate-variability-oceanic-nino-index">NOAA</a>:</p>
<ul>
<li>“The Oceanic Niño Index (ONI) is NOAA’s primary index for tracking the ocean part of ENSO, the El Niño-Southern Oscillation climate pattern.”</li>
<li>“The ONI is the rolling 3-month average temperature anomaly—difference from average—in the surface waters of the east-central tropical Pacific, near the International Dateline.”</li>
<li>“Index values of +0.5 or higher indicate El Niño. Values of -0.5 or lower indicate La Niña.”</li>
</ul>
<p>We downloaded these data from <code>https://psl.noaa.gov/data/correlation/oni.data</code> on September 27, 2024.</p>
</section>
<section id="ais-based-fishing-effort" class="level3" data-number="1.1.4">
<h3 data-number="1.1.4" class="anchored" data-anchor-id="ais-based-fishing-effort"><span class="header-section-number">1.1.4</span> AIS-based Fishing effort</h3>
<p>We use satellite-based individual vessel monitoring AIS data processed by Global Fishing Watch (<span class="citation" data-cites="kroodsma2018tracking">Kroodsma et al. (<a href="references.html#ref-kroodsma2018tracking" role="doc-biblioref">2018</a>)</span>). We use the V3 pipeline table <code>pipe_ais_v3_published.messages</code>. Variables of interest within this table include the following (descriptions are taken directly from the schema for <code>pipe_ais_v3_published.messages</code>):</p>
<ul>
<li><code>ssvid</code>: source specific vessel id; MMSI for AIS</li>
<li><code>hours</code>: time since the previous position in the segment</li>
<li><code>timestamp</code>: timestamp for position</li>
<li><code>lon</code>: longitude</li>
<li><code>lat</code>: latitude</li>
<li><code>night_loitering</code>: 1 if the seg_id of every message of a squid_jigger that is at night and not moving, 0 if not.</li>
</ul>
<p>In order to minimize noisy data, we only include AIS messages that have a <code>clean_segs</code> boolean (i.e., all messages must have <code>good_seg</code> boolean and must not have an <code>overlapping_and_short</code> boolean). We filter to just those messages where <code>night_loitering = 1</code>. For squid jigging vessels, GFW uses the heuristic of night loitering to identify when they are fishing. Therefore, any <code>hours</code> where <code>night_loitering = 1</code> can be classified as <code>fishing_hours</code></p>
<p>We take the raw high-resolution AIS data and aggregate <code>fishing_hours</code> spatially (by 0.25x0.25 degree pixels, which are roughly 27.75km x 27.75km at the equator), temporally by month, and by flag. We currently process data from 2016-01-01 through 2024-08-31.</p>
</section>
<section id="vessel-info" class="level3" data-number="1.1.5">
<h3 data-number="1.1.5" class="anchored" data-anchor-id="vessel-info"><span class="header-section-number">1.1.5</span> Vessel info</h3>
<p>Vessel characteristics data processed are by Global Fishing Watch (<span class="citation" data-cites="park2023tracking">Park et al. (<a href="references.html#ref-park2023tracking" role="doc-biblioref">2023</a>)</span>). We use the V3 pipeline table <code>pipe_ais_v3_published.vi_ssvid_v20240601</code>. Variables of interest within this table include the following (descriptions are taken directly from the schema for <code>pipe_ais_v3_published.vi_ssvid_v20240301</code>):</p>
<ul>
<li><code>ssvid</code>: source specific vessel id; MMSI for AIS</li>
<li><code>best.flag</code>: best flag state (ISO3) for the vessel</li>
<li><code>best.best_vessel_class</code>: best vessel class for the vessel (using official registry information where available, or the GFW vessel characteristics algorithm where not available)</li>
<li><code>best.best_engine_power_kw</code>: best engine power (kilowatts) for the vessel (using official registry information where available, or the GFW characteristics algorithm where not available)</li>
<li><code>activity.active_hours</code>: hours the vessel was broadcasting AIS and moving more than 0.1 knots</li>
<li><code>activity.offsetting</code>: true if this vessel has been seen with an offset postition at some point between 2012 and 2019</li>
<li><code>activity.overlap_hours_multinames</code>: the total numbers of hours of overlap between two segments where, over the time period of the two segments that overlap (including the non-overlapping time of the segments), the vessel broadcast two or more normalized name, where each normalized name was bradcast at least 10 or more times. That is a bit complicated, but the goal is to identify overlapping segments where there were likely more than one identity. (this should be 0; if it is &gt; 0, it can be used as a filter to remove potentially erroneous/noisy vessels)</li>
</ul>
<p>We filter to just those vessels where <code>best.best_vessel_class = squid_jigger</code>. Additionally, to reduce noise, we filter out vessels that broadcast exceedingly infrequently (i.e., <code>activitiy.active_hours &lt; 24</code>) or are noisy/spoofing/offsetting vessels (i.e., <code>NOT activity.offsetting OR activity.overlap_hours_multinames &gt; 0.</code>) They are simply not reliable and will not provide good effort estimates. This leaves us with 1,561 squid vessels for our analysis.</p>
</section>
<section id="night-light-detections-using-viirs-visible-infrared-imaging-radiometer-suite" class="level3" data-number="1.1.6">
<h3 data-number="1.1.6" class="anchored" data-anchor-id="night-light-detections-using-viirs-visible-infrared-imaging-radiometer-suite"><span class="header-section-number">1.1.6</span> Night light detections using VIIRS (Visible Infrared Imaging Radiometer Suite)</h3>
<p>As an alternative to AIS-based fishing effort, we can use the <a href="https://www.earthdata.nasa.gov/sensors/viirs">NASA VIIRS (Visible Infrared Imaging Radiometer Suite)</a> data product to detect night light emissions from vessels. When the appropriate radiance threshold is applied, these can generally be assumed to represent light-luring squid vessels. Since use only the single most accurate VIIRS detection measurements each day, these can also be thought of as representing a fishing effort metric of vessel-days. We use the VIIRS data as an alternative fishing effort metric to AIS-based fishing effort since AIS is not used on all vessels, and since it can also be disabled on the vessels that do use it.</p>
<p>We leverage the VIIRS boat detection (VBD) dataset developed by <span class="citation" data-cites="elvidge2015automatic">Elvidge et al. (<a href="references.html#ref-elvidge2015automatic" role="doc-biblioref">2015</a>)</span>. This dataset is available through GFW as the BigQuery table <code>pipe_viirs_production_v20180723.raw_vbd_global</code>. Variables of interest within this table include the following (descriptions are taken directly from the schema for <code>pipe_viirs_production_v20180723.raw_vbd_global</code>):</p>
<ul>
<li><code>id_Key</code>: Unique VBD ID.</li>
<li><code>Date_Mscan</code>: VBD pixel date-time at mid-point of DNB scan reported in Universal Time</li>
<li><code>Lat_DNB</code>: VBD pixel latitude from VIIRS DNB geolocation file</li>
<li><code>Lon_DNB</code>: VBD pixel longitude from VIIRS DNB geolocation file</li>
<li><code>Rad_DNB</code>: Radiance of VBD pixel in VIIRS DNB band<br>
</li>
<li><code>QF_Detect</code>: Integer quality flag for VBD pixel, yielding information about quality and type of detection</li>
<li><code>SATZ_GDNBO</code>: Satellite zenith angle relative to the VBD pixel measured from the local vertical (from VIIRS GDNBO file)</li>
<li><code>File_DNB</code>: VIIRS DNB HDF5 file</li>
</ul>
<p>We then apply similar processing as <span class="citation" data-cites="seto2023fishing">Seto et al. (<a href="references.html#ref-seto2023fishing" role="doc-biblioref">2023</a>)</span>, which includes the following steps:</p>
<ul>
<li>Reduce false detections near South America caused by the the South Atlantic Anomaly (an abundance of high-energy particles in the atmosphere).</li>
<li>Use a same radiance threshold of 10 nW cm−2 sr−1 used by <span class="citation" data-cites="seto2023fishing">Seto et al. (<a href="references.html#ref-seto2023fishing" role="doc-biblioref">2023</a>)</span> (and established by <span class="citation" data-cites="park2020illuminating">Park et al. (<a href="references.html#ref-park2020illuminating" role="doc-biblioref">2020</a>)</span>) in order to filter detections to those likely engaged in in pelagic light-luring activity.</li>
<li>To eliminate double-counting when there may be multiple satellite overpasses on a single night, only count detections from the overpass with the smallest satellite zenith angle (smaller zenith angles are more accurate)</li>
</ul>
<p>We then finally aggregate the total detections for each 0.25x0.25 degree pixel and month.</p>
</section>
<section id="eez-information" class="level3" data-number="1.1.7">
<h3 data-number="1.1.7" class="anchored" data-anchor-id="eez-information"><span class="header-section-number">1.1.7</span> EEZ information</h3>
<p>For each 0.25x0.25 degree pixel, we determine a number of EEZ features. To do so, we leverage the EEZ shapefiles and boundaries from <a href="https://www.marineregions.org/downloads.php">Marine Regions v12</a>(<span class="citation" data-cites="marineregionsv12">Institute (<a href="references.html#ref-marineregionsv12" role="doc-biblioref">2023</a>)</span>). We first determine whether the centroid of the pixel is on the high seas or within an EEZ (<code>high_seas</code>). For pixels that are within an EEZ (<code>eez_id</code>), we determine its Marine Regions EEZ ID and its ISO3 sovereign country code (<code>pixel_sovereign1_iso3</code>); for pixels that are on the high seas, the EEZ id takes a value of <code>high_seas</code> and the country code also takes a value of <code>high_seas</code>. We next determine the distance in meters from the centroid of the pixel to the nearest 200nm EEZ/high seas boundary line (<code>distance_to_nearest_eez_m</code>); so for pixels on the high seas, this number represents the distance to the nearest EEZ; for pixels inside EEZs, this represents the shortest distance to the high sea. For high seas pixels, we finally determine the country EEZ ID (<code>nearest_eez_id</code>) and ISO3 sovereign country code (<code>nearest_pixel_sovereign1_iso3</code>) of this nearest EEZ; for pixels that are within an EEZ, this both take the values of the EEZ the pixel is within. Note that for our analysis, we exclude the Anarctica EEZ and treat it as the high seas; we also exclude any joint claim or disputed EEZs.</p>
</section>
<section id="joined-datasets" class="level3" data-number="1.1.8">
<h3 data-number="1.1.8" class="anchored" data-anchor-id="joined-datasets"><span class="header-section-number">1.1.8</span> Joined datasets</h3>
<section id="sst-and-ais-based-effort" class="level4" data-number="1.1.8.1">
<h4 data-number="1.1.8.1" class="anchored" data-anchor-id="sst-and-ais-based-effort"><span class="header-section-number">1.1.8.1</span> SST and AIS-based effort</h4>
<p>One version of the final dataset we use for our analysis is a combination of the gridded AIS-based fishing effort data and gridded SST data. We inner join the AIS-based effort and SST datasets by 0.25x0.25 degree pixel and month. We finally left join the Oceanic Niño Index (ONI) monthly data (by month) and the EEZ information (by pixel). Since the AIS-based effort dataset is disaggregated by flag, each row in the joined dataset represents flag-level effort in a given pixel and month, with the corresponding SST for that pixel and month.</p>
<p>Note that the joined dataset includes pixel-month-flags when have SST data but with no AIS-based fishing effort (i.e., the data are <em>not</em> conditional on there being some fishing effort for any given pixel-month-flag). These rows get a value of <code>0</code> for <code>fishing_hours</code> and <code>fishing_kw_hours</code>.</p>
<p>The joined dataset can be loaded in R using the command <code>targets::tar_load(joined_dataset_ais)</code>. The dataset has the following colums:</p>
<ul>
<li><strong>month</strong>: Month (first day of month) (date)<br>
</li>
<li><strong>flag</strong> : Fishing vessel flag (character)</li>
<li><strong>lon_bin</strong>: 0.25 degree longitude bin (degrees) (numeric)<br>
</li>
<li><strong>lat_bin</strong>: 0.25 degree latitude bin (degrees) (numeric)<br>
</li>
<li><strong>flag</strong>: Fishing flag (character)<br>
</li>
<li><strong>sst_deg_c_mean</strong>: Mean sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>sst_deg_c_sd</strong>: Standard deviation of sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>sst_deg_c_min</strong>: Minimum sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>sst_deg_c_max</strong>: Maxiumum sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>fishing_hours</strong>: Total fishing effort across vessels (hours) (numeric)<br>
</li>
<li><strong>fishing_kw_hours</strong>: Total fishing effort across vessels (kW-hours) (numeric)<br>
</li>
<li><strong>oceanic_nino_index</strong>: Oceanic Niño Index (ONI) (numeric)</li>
<li><strong>eez_id</strong>: Marine regions EEZ ID of the pixel; for high seas pixels, this takes a value of <code>high_seas</code> (string)</li>
<li><strong>distance_to_nearest_eez_m</strong>: This is the distance to the nearest 200nm EEZ/high seas boundary (for pixels on the high seas, this number represents the distance to the nearest EEZ; for pixels inside EEZs, this represents the shortest distance to the high seas) (meters) (numeric)</li>
<li><strong>nearest_eez_id</strong>: For high seas pixels, this is the Marine regions EEZ ID of the nearest EEZ pixel; for pixels within an EEZ, this is the Marine regions EEZ ID of the pixel (string)</li>
<li><strong>eez_iso3</strong>: For pixels within an EEZ, this is the ISO3 sovereign country code for the pixel; for high seas pixels, this takes a value of <code>high_seas</code> (string)</li>
<li><strong>nearest_eez_iso3</strong>: For high seas pixels, this is the ISO3 sovereign country code for the nearest EEZ pixel; for pixels within an EEZ, this the pixel’s ISO3 sovereign country code (string)</li>
<li><strong>high_seas</strong>: This is a logical indicating whether the pixel is within the high seas or not (logical)</li>
</ul>
</section>
</section>
<section id="joined-datasets-1" class="level3" data-number="1.1.9">
<h3 data-number="1.1.9" class="anchored" data-anchor-id="joined-datasets-1"><span class="header-section-number">1.1.9</span> Joined datasets</h3>
<section id="sst-and-ais-based-effort-1" class="level4" data-number="1.1.9.1">
<h4 data-number="1.1.9.1" class="anchored" data-anchor-id="sst-and-ais-based-effort-1"><span class="header-section-number">1.1.9.1</span> SST and AIS-based effort</h4>
<p>One version of the final dataset we use for our analysis is a combination of the gridded AIS-based fishing effort data and gridded SST data. We inner join the AIS-based effort and SST datasets by 0.25x0.25 degree pixel and month. We finally left join the Oceanic Niño Index (ONI) monthly data (by month) and the EEZ information (by pixel). Since the AIS-based effort dataset is disaggregated by flag, each row in the joined dataset represents flag-level effort in a given pixel and month, with the corresponding SST for that pixel and month.</p>
<p>Note that the joined dataset does not contain flag-pixel-months with zero AIS-based fishing effort (i.e., the data are conditional on there being some effort for any given flag-pixel-month). If desired, once we have a spatial scope with which to restrict the analysis, we could construct a dataset for that bounding box that includes zero fishing effort flag-pixel-month rows.</p>
<p>The joined dataset can be loaded in R using the command <code>targets::tar_load(joined_dataset_ais)</code>. The dataset has the following colums:</p>
<ul>
<li><strong>month</strong>: Month (first day of month) (date)<br>
</li>
<li><strong>flag</strong> : Fishing vessel flag (character)</li>
<li><strong>lon_bin</strong>: 0.25 degree longitude bin (degrees) (numeric)<br>
</li>
<li><strong>lat_bin</strong>: 0.25 degree latitude bin (degrees) (numeric) * <strong>flag</strong>: Fishing flag (character)<br>
</li>
<li><strong>sst_deg_c_mean</strong>: Mean sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>sst_deg_c_sd</strong>: Standard deviation of sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>sst_deg_c_min</strong>: Minimum sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>sst_deg_c_max</strong>: Maxiumum sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>fishing_hours</strong>: Total fishing effort across vessels (hours) (numeric)<br>
</li>
<li><strong>fishing_kw_hours</strong>: Total fishing effort across vessels (kW-hours) (numeric)<br>
</li>
<li><strong>oceanic_nino_index</strong>: Oceanic Niño Index (ONI) (numeric)</li>
<li><strong>eez_id</strong>: Marine regions EEZ ID of the pixel; for high seas pixels, this takes a value of <code>high_seas</code> (string)</li>
<li><strong>distance_to_nearest_eez_m</strong>: This is the distance to the nearest 200nm EEZ/high seas boundary (for pixels on the high seas, this number represents the distance to the nearest EEZ; for pixels inside EEZs, this represents the shortest distance to the high seas) (meters) (numeric)</li>
<li><strong>nearest_eez_id</strong>: For high seas pixels, this is the Marine regions EEZ ID of the nearest EEZ pixel; for pixels within an EEZ, this is the Marine regions EEZ ID of the pixel (string)</li>
<li><strong>eez_iso3</strong>: For pixels within an EEZ, this is the ISO3 sovereign country code for the pixel; for high seas pixels, this takes a value of <code>high_seas</code> (string)</li>
<li><strong>nearest_eez_iso3</strong>: For high seas pixels, this is the ISO3 sovereign country code for the nearest EEZ pixel; for pixels within an EEZ, this the pixel’s ISO3 sovereign country code (string)</li>
<li><strong>high_seas</strong>: This is a logical indicating whether the pixel is within the high seas or not (logical)</li>
</ul>
<p>Here we summarize these data (<a href="#tbl-summary-stats-joined-dataset-ais">Table&nbsp;<span>1.1</span></a>):</p>
<div id="tbl-summary-stats-joined-dataset-ais" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;1.1: Summary statistics for joined dataset that includes gridded SST and AIS-based fishing effort</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-summary-stats-joined-dataset-ais-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-summary-stats-joined-dataset-ais" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<caption>(a) Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">joined_dataset_ais</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">41267304</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POSIXct</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><strong>Variable type: character</strong></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">flag</td>
<td style="text-align: right;">4585256</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">eez_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nearest_eez_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">eez_iso3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nearest_eez_iso3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><strong>Variable type: logical</strong></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">high_seas</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: left;">TRU: 32753448, FAL: 8513856</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><strong>Variable type: numeric</strong></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lon_bin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-102.56</td>
<td style="text-align: right;">16.08</td>
<td style="text-align: right;">-130.00</td>
<td style="text-align: right;">-116.50</td>
<td style="text-align: right;">-102.75</td>
<td style="text-align: right;">-89.00</td>
<td style="text-align: right;">-70.25</td>
<td style="text-align: left;">▇▇▇▇▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">lat_bin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-15.81</td>
<td style="text-align: right;">14.44</td>
<td style="text-align: right;">-40.00</td>
<td style="text-align: right;">-28.25</td>
<td style="text-align: right;">-16.50</td>
<td style="text-align: right;">-3.25</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sst_deg_c_mean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.85</td>
<td style="text-align: right;">4.19</td>
<td style="text-align: right;">10.30</td>
<td style="text-align: right;">19.96</td>
<td style="text-align: right;">23.54</td>
<td style="text-align: right;">26.27</td>
<td style="text-align: right;">31.11</td>
<td style="text-align: left;">▁▃▆▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">sst_deg_c_sd</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sst_deg_c_min</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.17</td>
<td style="text-align: right;">4.23</td>
<td style="text-align: right;">8.96</td>
<td style="text-align: right;">19.23</td>
<td style="text-align: right;">22.83</td>
<td style="text-align: right;">25.62</td>
<td style="text-align: right;">30.60</td>
<td style="text-align: left;">▁▃▆▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">sst_deg_c_max</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23.52</td>
<td style="text-align: right;">4.16</td>
<td style="text-align: right;">10.57</td>
<td style="text-align: right;">20.69</td>
<td style="text-align: right;">24.23</td>
<td style="text-align: right;">26.91</td>
<td style="text-align: right;">32.31</td>
<td style="text-align: left;">▁▃▆▇▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fishing_hours</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">5.68</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3430.50</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">fishing_kw_hours</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">74.70</td>
<td style="text-align: right;">6175.53</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3745373.67</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">oceanic_nino_index</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">-1.27</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: left;">▇▆▆▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">nearest_eez_distance_m</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">592454.62</td>
<td style="text-align: right;">442780.49</td>
<td style="text-align: right;">44.19</td>
<td style="text-align: right;">215031.75</td>
<td style="text-align: right;">497222.36</td>
<td style="text-align: right;">911947.29</td>
<td style="text-align: right;">1769305.06</td>
<td style="text-align: left;">▇▅▃▂▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><strong>Variable type: POSIXct</strong></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2016-01-01</td>
<td style="text-align: left;">2024-08-01</td>
<td style="text-align: left;">2020-04-16</td>
<td style="text-align: right;">104</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="sst-and-viirs-detections" class="level4" data-number="1.1.9.2">
<h4 data-number="1.1.9.2" class="anchored" data-anchor-id="sst-and-viirs-detections"><span class="header-section-number">1.1.9.2</span> SST and VIIRS detections</h4>
<p>The other version of the final dataset we use for our analysis is a combination of the gridded VIIRS detections data and gridded SST data, and the gridded VIIRS detections. We inner join the VIIRS detections and SST datasets by 0.25x0.25 degree pixel and month. Note that the VIIRS detection dataset only covers January 2017 through December 2021, so that is also the time range of this joined dataset. We finally left join the Oceanic Niño Index (ONI) monthly data (by month) and the EEZ information (by pixel). Since the VIIRS dataset is not disaggregated by flag, each row in this joined dataset represents total detections in a given pixel and month, with the corresponding SST for that pixel and month.</p>
<p>Note that the joined dataset includes pixel-months when have SST data but with zero VIIRS detections (i.e., the data are <em>not</em> conditional on there being some detections for any given pixel-month). These rows get a value of <code>0</code> for <code>viirs_detections</code>.</p>
<p>The joined dataset can be loaded in R using the command <code>targets::tar_load(joined_dataset_viirs)</code>. The dataset has the following colums:</p>
<ul>
<li><strong>month</strong>: Month (first day of month) (date)<br>
</li>
<li><strong>lon_bin</strong>: 0.25 degree longitude bin (degrees) (numeric)<br>
</li>
<li><strong>lat_bin</strong>: 0.25 degree latitude bin (degrees) (numeric)</li>
<li><strong>sst_deg_c_mean</strong>: Mean sea surface temperature, aggregated from the raw daily 0.25x0.25 degree data (degrees C) (numeric)</li>
<li><strong>viirs_detections</strong>: Night light detections from the VIIRS dataset (numeric)<br>
</li>
<li><strong>oceanic_nino_index</strong>: Oceanic Niño Index (ONI) (numeric)</li>
<li><strong>eez_id</strong>: Marine regions EEZ ID of the pixel; for high seas pixels, this takes a value of NA (string)</li>
<li><strong>distance_to_nearest_eez_m</strong>: This is the distance to the nearest 200nm EEZ/high seas boundary (for pixels on the high seas, this number represents the distance to the nearest EEZ; for pixels inside EEZs, this represents the shortest distance to the high seas) (meters) (numeric)</li>
<li><strong>nearest_eez_id</strong>: For high seas pixels, this is the Marine regions EEZ ID of the nearest EEZ pixel; for pixels within an EEZ, this is the Marine regions EEZ ID of the pixel (string)</li>
<li><strong>eez_iso3</strong>: For pixels within an EEZ, this is the ISO3 sovereign country code for the pixel; for high seas pixels, this takes a value of <code>high_seas</code> (string)</li>
<li><strong>nearest_eez_iso3</strong>: For high seas pixels, this is the ISO3 sovereign country code for the nearest EEZ pixel; for pixels within an EEZ, this the pixel’s ISO3 sovereign country code (string)</li>
<li><strong>high_seas</strong>: This is a logical indicating whether the pixel is within the high seas or not (logical)</li>
</ul>
<p>Here we summarize these data (tbl-summary-stats-joined-dataset-VIIRS):</p>
<div id="tbl-summary-stats-joined-dataset-VIIRS" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;1.2: Summary statistics for joined dataset that includes gridded SST and VIIRS detections</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-summary-stats-joined-dataset-VIIRS-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-summary-stats-joined-dataset-VIIRS" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<caption>(a) Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">joined_dataset_viirs</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">4585256</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Key</td>
<td style="text-align: left;">NULL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">character</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">POSIXct</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><strong>Variable type: character</strong></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">eez_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">nearest_eez_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">eez_iso3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">nearest_eez_iso3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><strong>Variable type: logical</strong></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 14%">
<col style="width: 20%">
<col style="width: 7%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">high_seas</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: left;">TRU: 3639272, FAL: 945984</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><strong>Variable type: numeric</strong></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lon_bin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-102.56</td>
<td style="text-align: right;">16.08</td>
<td style="text-align: right;">-130.00</td>
<td style="text-align: right;">-116.50</td>
<td style="text-align: right;">-102.75</td>
<td style="text-align: right;">-89.00</td>
<td style="text-align: right;">-70.25</td>
<td style="text-align: left;">▇▇▇▇▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">lat_bin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-15.81</td>
<td style="text-align: right;">14.44</td>
<td style="text-align: right;">-40.00</td>
<td style="text-align: right;">-28.25</td>
<td style="text-align: right;">-16.50</td>
<td style="text-align: right;">-3.25</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sst_deg_c_mean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.85</td>
<td style="text-align: right;">4.19</td>
<td style="text-align: right;">10.30</td>
<td style="text-align: right;">19.96</td>
<td style="text-align: right;">23.54</td>
<td style="text-align: right;">26.27</td>
<td style="text-align: right;">31.11</td>
<td style="text-align: left;">▁▃▆▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">sst_deg_c_sd</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sst_deg_c_min</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.17</td>
<td style="text-align: right;">4.23</td>
<td style="text-align: right;">8.96</td>
<td style="text-align: right;">19.23</td>
<td style="text-align: right;">22.83</td>
<td style="text-align: right;">25.62</td>
<td style="text-align: right;">30.60</td>
<td style="text-align: left;">▁▃▆▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">sst_deg_c_max</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23.52</td>
<td style="text-align: right;">4.16</td>
<td style="text-align: right;">10.57</td>
<td style="text-align: right;">20.69</td>
<td style="text-align: right;">24.23</td>
<td style="text-align: right;">26.91</td>
<td style="text-align: right;">32.31</td>
<td style="text-align: left;">▁▃▆▇▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">viirs_detections</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">675.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">oceanic_nino_index</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">-1.27</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: left;">▇▆▆▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nearest_eez_distance_m</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">592454.62</td>
<td style="text-align: right;">442780.54</td>
<td style="text-align: right;">44.19</td>
<td style="text-align: right;">215031.75</td>
<td style="text-align: right;">497222.36</td>
<td style="text-align: right;">911947.29</td>
<td style="text-align: right;">1769305.06</td>
<td style="text-align: left;">▇▅▃▂▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><strong>Variable type: POSIXct</strong></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2016-01-01</td>
<td style="text-align: left;">2024-08-01</td>
<td style="text-align: left;">2020-04-16</td>
<td style="text-align: right;">104</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="geographic-analysis-scope" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="geographic-analysis-scope"><span class="header-section-number">1.2</span> Geographic analysis scope</h2>
<p>Our proposed geographic scope encompasses a bounding box with a longitude range from -130 degrees to -70 degrees and a latitude range from -40 degrees to 10 degrees (<a href="#fig-effort-map-with-scope">Figure&nbsp;<span>1.1</span></a>; <a href="#fig-effort-map-with-scope-zoom">Figure&nbsp;<span>1.2</span></a>). This longitude range encompasses band of equatorial fishing effort to the west and the EEZs off the western coast of South America. The latitude range covers the maximum latitude of the <a href="https://data.apps.fao.org/map/catalog/srv/eng/catalog.search#/metadata/fao-rfb-map-sprfmo">South Pacific Regional Fisheries Management Organisation (SPRFMO)</a> and extends beyond the southern latitude where the north-south band of fishing effort is currently concentrated. The bounding box extends beyond where fishing effort is currently concentrated, which means that in our predictions under future climate change scenarios, we could capture shifts of fishing effort beyond it current range.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-effort-map-with-scope" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="methods_files/figure-html/fig-effort-map-with-scope-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1.1: Map of squid jigger fishing effort from 2016 through August 2024, aggregating effort across effort, flags, and time for each pixel. EEZ boundaries from Marine Regions V12 are shown in orange; the SPRFRMO boundary is shown in yellow; the currently proposed analysis scope bounding box is shown as a red outline.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-effort-map-with-scope-zoom" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="methods_files/figure-html/fig-effort-map-with-scope-zoom-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1.2: Zoomed in map of squid jigger fishing effort from 2016 through August 2024 to the proposed analysis scope, aggregating effort across effort, flags, and time for each pixel. EEZ boundaries from Marine Regions V12 are shown in orange; the SPRFRMO boundary is shown in yellow; the currently proposed analysis scope bounding box is shown as a red outline.</figcaption>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-elvidge2015automatic" class="csl-entry" role="listitem">
Elvidge, CD, M Zhizhin, K Baugh, and FC Hsu. 2015. <span>“Automatic Boat Identification System for VIIRS Low Light Imaging Data, Remote Sens., 7, 3020–3036.”</span>
</div>
<div id="ref-huang2021improvements" class="csl-entry" role="listitem">
Huang, Boyin, Chunying Liu, Viva Banzon, Eric Freeman, Garrett Graham, Bill Hankins, Tom Smith, and Huai-Min Zhang. 2021. <span>“Improvements of the Daily Optimum Interpolation Sea Surface Temperature (DOISST) Version 2.1.”</span> <em>Journal of Climate</em> 34 (8): 2923–39.
</div>
<div id="ref-marineregionsv12" class="csl-entry" role="listitem">
Institute, Flanders Marine. 2023. <span>“Maritime Boundaries Geodatabase, Version 12.”</span> <em>Available Online at Https://Www.marineregions.org/. Https://Doi.org/10.14284/628</em>.
</div>
<div id="ref-iturbide2021repository" class="csl-entry" role="listitem">
Iturbide, Maialen, Jesús Fernández, José Manuel Gutiérrez, Joaquı́n Bedia, Ezequiel Cimadevilla, Javier Dı́ez-Sierra, Rodrigo Manzanas, et al. 2021. <span>“Repository Supporting the Implementation of FAIR Principles in the IPCC-WG1 Atlas. Zenodo.”</span> Intergovernmental Panel on Climate Change (IPCC) Geneva.
</div>
<div id="ref-kroodsma2018tracking" class="csl-entry" role="listitem">
Kroodsma, David A, Juan Mayorga, Timothy Hochberg, Nathan A Miller, Kristina Boerder, Francesco Ferretti, Alex Wilson, et al. 2018. <span>“Tracking the Global Footprint of Fisheries.”</span> <em>Science</em> 359 (6378): 904–8.
</div>
<div id="ref-park2020illuminating" class="csl-entry" role="listitem">
Park, Jaeyoon, Jungsam Lee, Katherine Seto, Timothy Hochberg, Brian A Wong, Nathan A Miller, Kenji Takasaki, et al. 2020. <span>“Illuminating Dark Fishing Fleets in North Korea.”</span> <em>Science Advances</em> 6 (30): eabb1197.
</div>
<div id="ref-park2023tracking" class="csl-entry" role="listitem">
Park, Jaeyoon, Jennifer Van Osdel, Joanna Turner, Courtney M Farthing, Nathan A Miller, Hannah L Linder, Guillermo Ortuño Crespo, Gabrielle Carmine, and David A Kroodsma. 2023. <span>“Tracking Elusive and Shifting Identities of the Global Fishing Fleet.”</span> <em>Science Advances</em> 9 (3): eabp8200.
</div>
<div id="ref-seto2023fishing" class="csl-entry" role="listitem">
Seto, Katherine L, Nathan A Miller, David Kroodsma, Quentin Hanich, Masanori Miyahara, Rui Saito, Kristina Boerder, Masaki Tsuda, Yoshioki Oozeki, and Osvaldo Urrutia S. 2023. <span>“Fishing Through the Cracks: The Unregulated Nature of Global Squid Fisheries.”</span> <em>Science Advances</em> 9 (10): eadd8125.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./eda.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>